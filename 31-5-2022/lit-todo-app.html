<!DOCTYPE html>
<html>

<body>

    <h3>Stage: 1</h3>
    <todo-app>
    </todo-app>

    <h3>Stage: 2</h3>
    <todo-app-stage2>
    </todo-app-stage2>

    <script type="module">
        import { LitElement, html } from 'https://unpkg.com/lit-element?module';
        let todoheading = "Todo App - building elements dynamically";
        class TodoAPP extends LitElement {
            constructor() {
                super();
                this.todos = [
                    { text: 'event binding', finished: true },
                    { text: 'looping', finished: false },
                    { text: 'styling', finished: true },
                ];
            }
            render() {

                return html`
                <h3>${todoheading}</h3> 
                 <input id="addTodoInput" placeholder="Name" />
                 <button @click=${this.addNewItem}>Add</button>
                <ol>
                    ${this.todos.map((data) => html`<li style=color:${data.finished ? 'green' : 'red'}>${data.text} - ${data.finished ? 'Finished' : 'Unfinished'}</li>`)}
                </ol>    
                `;
            }

            addNewItem() {
                const input = this.shadowRoot.getElementById('addTodoInput');
                const inputText = input.value == '' ? "(empty)" : input.value;
                input.value = '';
                this.todos.push({ text: inputText, finished: false });
                // update dom lit elements 
                this.requestUpdate();
            }
        }

        //Stage 2
        class TodoAPP1 extends LitElement {

            static get properties() {
                return {
                    todos: { type: Array },
                };
            }

            constructor() {
                super();
                this.todos = [
                    { text: 'event binding', finished: true },
                    { text: 'looping', finished: false },
                    { text: 'styling', finished: true },
                ];
            }
            render() {

                return html`
                <h3>${todoheading}</h3> 
                 <input id="addTodoInput" placeholder="Name" />
                 <button @click=${this.addNewItem}>Add</button>
                 <button @click=${this.removeItem}>X</button>
                <ol>
                    ${this.todos.map((data) => html`<li style=color:${data.finished ? 'green' : 'red'}>${data.text} - ${data.finished ? 'Finished' : 'Unfinished'}</li>`)
                    }
                </ol>    
                `;
            }

            addNewItem() {
                const input = this.shadowRoot.getElementById('addTodoInput');
                const inputText = input.value == '' ? "(empty)" : input.value;
                input.value = '';
                this.todos = [...this.todos, { text: inputText, finished: false }];
                // update dom lit elements 
                // this.requestUpdate();
            }

            removeItem() {
                const input = this.shadowRoot.getElementById('addTodoInput');
                const inputText = input.value;
                this.todos = this.todos.filter((args) => {
                    return args.text.trim().indexOf(inputText.trim()) == -1;
                });
                input.value = '';
                // update dom lit elements 
                // this.requestUpdate();
            }
        }
        customElements.define('todo-app-stage2', TodoAPP1);
        customElements.define('todo-app', TodoAPP);
    </script>



</body>

</html>